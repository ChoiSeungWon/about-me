<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Spring Boot 테스트 코드 작성 | SeungWon 기술블로그</title>
    <meta name="description" content="Just playing around">
    
    
    <link rel="preload" href="/about-me/assets/css/0.styles.aad00d23.css" as="style"><link rel="preload" href="/about-me/assets/js/app.1fd5ee7f.js" as="script"><link rel="preload" href="/about-me/assets/js/12.0a416c4b.js" as="script"><link rel="prefetch" href="/about-me/assets/js/10.a427f655.js"><link rel="prefetch" href="/about-me/assets/js/11.59b8b1ef.js"><link rel="prefetch" href="/about-me/assets/js/13.4f90a351.js"><link rel="prefetch" href="/about-me/assets/js/14.9c5ecfe1.js"><link rel="prefetch" href="/about-me/assets/js/15.4af529ca.js"><link rel="prefetch" href="/about-me/assets/js/16.1a5022af.js"><link rel="prefetch" href="/about-me/assets/js/17.e32e52bb.js"><link rel="prefetch" href="/about-me/assets/js/18.18c05ca0.js"><link rel="prefetch" href="/about-me/assets/js/19.54bd122f.js"><link rel="prefetch" href="/about-me/assets/js/2.6be79372.js"><link rel="prefetch" href="/about-me/assets/js/20.5fe215a6.js"><link rel="prefetch" href="/about-me/assets/js/3.05835132.js"><link rel="prefetch" href="/about-me/assets/js/4.58042996.js"><link rel="prefetch" href="/about-me/assets/js/5.053d4dcf.js"><link rel="prefetch" href="/about-me/assets/js/6.bb492f85.js"><link rel="prefetch" href="/about-me/assets/js/7.be9fab67.js"><link rel="prefetch" href="/about-me/assets/js/8.f5703b5a.js"><link rel="prefetch" href="/about-me/assets/js/9.140de9e0.js">
    <link rel="stylesheet" href="/about-me/assets/css/0.styles.aad00d23.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/about-me/" class="home-link router-link-active"><!----> <span class="site-name">SeungWon 기술블로그</span></a> <div class="links" style="max-width:nullpx;"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/about-me/" class="nav-link">Home</a></div><div class="nav-item"><a href="/about-me/tech/" class="nav-link">Tech</a></div><div class="nav-item"><a href="/about-me/swchoi/" class="nav-link">about</a></div> <a href="https://github.com/ChoiSeungWon/about-me" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav></div></header> <div class="sidebar-mask"></div> <div class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/about-me/" class="nav-link">Home</a></div><div class="nav-item"><a href="/about-me/tech/" class="nav-link">Tech</a></div><div class="nav-item"><a href="/about-me/swchoi/" class="nav-link">about</a></div> <a href="https://github.com/ChoiSeungWon/about-me" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav>  <ul class="sidebar-links"><li><div class="sidebar-group first collapsable"><p class="sidebar-heading open"><span>스프링 부트와 AWS로 혼자 구현하는 웹 서비스</span> <span class="arrow down"></span></p> <ul class="sidebar-group-items"><li><a href="/about-me/spring/chater01/" class="sidebar-link">Gradle Spring Boot 프로젝트 생성</a></li><li><a href="/about-me/spring/chater02/" class="active sidebar-link">Spring Boot 테스트 코드 작성</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/about-me/spring/chater02/#_1-ttd란" class="sidebar-link">1. TTD란?</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/about-me/spring/chater02/#tdd를-왜-사용하는가" class="sidebar-link">TDD를 왜 사용하는가?</a></li></ul></li><li class="sidebar-sub-header"><a href="/about-me/spring/chater02/#_2-controller-테스트-코드-작성하기" class="sidebar-link">2. Controller 테스트 코드 작성하기</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/about-me/spring/chater02/#application-class-작성" class="sidebar-link">Application Class 작성</a></li><li class="sidebar-sub-header"><a href="/about-me/spring/chater02/#hellocontroller-class-작성" class="sidebar-link">HelloController Class 작성</a></li><li class="sidebar-sub-header"><a href="/about-me/spring/chater02/#hellocontrollertest-class-작성" class="sidebar-link">HelloControllerTest Class 작성</a></li></ul></li><li class="sidebar-sub-header"><a href="/about-me/spring/chater02/#_3-lombok-소개-및-설치하기" class="sidebar-link">3. Lombok 소개 및 설치하기</a></li><li class="sidebar-sub-header"><a href="/about-me/spring/chater02/#_4-dto-롬북-테스트-코드-작성하기" class="sidebar-link">4. DTO 롬북 테스트 코드 작성하기</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/about-me/spring/chater02/#helloresponsedto-클래스-생성" class="sidebar-link">HelloResponseDto 클래스 생성</a></li><li class="sidebar-sub-header"><a href="/about-me/spring/chater02/#helloresponsedtotest-클래스-생성" class="sidebar-link">HelloResponseDtoTest 클래스 생성</a></li><li class="sidebar-sub-header"><a href="/about-me/spring/chater02/#hellocontroller-메소드-추가" class="sidebar-link">HelloController 메소드 추가</a></li><li class="sidebar-sub-header"><a href="/about-me/spring/chater02/#hellocontrollertest-메소드-추가" class="sidebar-link">HelloControllerTest 메소드 추가</a></li></ul></li></ul></li><li><a href="/about-me/spring/chater03/" class="sidebar-link">Spring Boot에서 JPA 사용하기</a></li><li><a href="/about-me/spring/chater04/" class="sidebar-link">Mustache로 화면 구성하기</a></li><li><a href="/about-me/spring/chater05/" class="sidebar-link">스프링 시큐리티와 OAuth 2.0으로 로그인 기능 구현하기</a></li><li><a href="/about-me/spring/chater06/" class="sidebar-link">AWS 서버 환경을 만들어보자</a></li><li><a href="/about-me/spring/chater07/" class="sidebar-link">AWS 데이터베이스 환경을 만들어보자</a></li><li><a href="/about-me/spring/chater08/" class="sidebar-link">EC2 서버에 스프링부트 배포</a></li><li><a href="/about-me/spring/chater09/" class="sidebar-link">Travis CI 배포 자동화</a></li><li><a href="/about-me/spring/chater10/" class="sidebar-link">NGINX 무중단 배포</a></li></ul></div></li></ul> </div> <div class="page"> <div class="content"><h1 id="spring-boot-테스트-코드-작성"><a href="#spring-boot-테스트-코드-작성" aria-hidden="true" class="header-anchor">#</a> Spring Boot 테스트 코드 작성</h1> <h2 id="_1-ttd란"><a href="#_1-ttd란" aria-hidden="true" class="header-anchor">#</a> 1. TTD란?</h2> <p><code>&quot;테스트 주도 개발: 테스트가 개발을 이끌어 나간다.&quot;</code>라고 정의할 수 있다.</p> <p>메소드 나 함수 같은 프로그램 모듈을 작성할 때</p> <p>‘작성 종료조건을 먼저 정해놓고 코딩을 시작 한다’는 의미로 받아들이면 편하다.</p> <p><img src="/about-me/assets/img/test1.2df0f774.png" width="450px" height="450px" title="TDD" alt="TDD"><br></p> <ul><li><code>RED</code> : 항상 실패하는 테스트를 먼저 작성</li> <li><code>GREEN</code> : 테스트에 통과하는 프로덕션 코드 작성</li> <li><code>REFACTOR</code> : 테스트가 통과하면 프로덕션 코드를 리팩토링</li></ul> <p>위의 레드 그린 사이클 처럼 우선 테스트를 작성하고 그걸 통과하는 코드를 만들고 해당 과정을 반복하면서</p> <p>제대로 동작하는지에 대한 피드백을 적극적으로 받는 것이다.</p> <h3 id="tdd를-왜-사용하는가"><a href="#tdd를-왜-사용하는가" aria-hidden="true" class="header-anchor">#</a> TDD를 왜 사용하는가?</h3> <ul><li>개발 단계 초기에 문제를 발견하게 해준다.</li> <li>추후에 코드를 리팩토링하거나 라이브러리 업그레이드 등에서 기존기능이 올바르게 작동하는지 확인할 수 있다.</li> <li>기능에 대한 불확실성을 감소시켜준다.</li> <li>시스템에 대한 실제 문서를 제공한다. 즉, 단위 테스트 자체가 문서로 사용할 수 있다.</li></ul> <h2 id="_2-controller-테스트-코드-작성하기"><a href="#_2-controller-테스트-코드-작성하기" aria-hidden="true" class="header-anchor">#</a> 2. Controller 테스트 코드 작성하기</h2> <h3 id="application-class-작성"><a href="#application-class-작성" aria-hidden="true" class="header-anchor">#</a> Application Class 작성</h3> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>swchoi<span class="token punctuation">.</span>webservice<span class="token punctuation">.</span>springboot</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>boot</span><span class="token punctuation">.</span><span class="token class-name">SpringApplication</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>boot<span class="token punctuation">.</span>autoconfigure</span><span class="token punctuation">.</span><span class="token class-name">SpringBootApplication</span><span class="token punctuation">;</span>

<span class="token annotation punctuation">@SpringBootApplication</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Application</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">SpringApplication</span><span class="token punctuation">.</span><span class="token function">run</span><span class="token punctuation">(</span><span class="token class-name">Application</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span> args<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>Application 클래스는 앞으로 만들 프로젝트의 <strong>메인 클래스</strong>가 됩니다.</p> <ul><li><strong>@SpringBootApplication</strong>으로 인해 스프링 부트의 자동설정, 스프링 Bean 일기기와 생성을 모두 자동으로 설정된다.</li> <li><strong>@SpringBootApplication이 있는 위치부터 설정을 읽어</strong>가기 때문에 이 클래스는 항상 <strong>프로젝트의 최상단에 위치</strong>해야 한다.</li> <li>main 메소드에서 실행하는 <strong>SpringApplication.run</strong>으로 인해 내장 WAS(Web Application Server, 웹 어플리케이션 서버)를 실행한다.</li> <li>내장 WAS란 별도로 외부에 WAS를 두지 않고 애플리케이션을 실행할 때 내부에서 WAS를 실행하는 것을 이야기한다. 이렇게 되면 항상 서버에 톰캣(Tomcat)을 설치할 필요가 없게 되고, 스프링 부트로 만들어진 Jar 파일(실행 가능한 Java 패키징 파일)로 실행하면 된다.</li></ul> <h3 id="hellocontroller-class-작성"><a href="#hellocontroller-class-작성" aria-hidden="true" class="header-anchor">#</a> HelloController Class 작성</h3> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>swchoi<span class="token punctuation">.</span>webservice<span class="token punctuation">.</span>springboot<span class="token punctuation">.</span>web</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>web<span class="token punctuation">.</span>bind<span class="token punctuation">.</span>annotation</span><span class="token punctuation">.</span><span class="token class-name">GetMapping</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>web<span class="token punctuation">.</span>bind<span class="token punctuation">.</span>annotation</span><span class="token punctuation">.</span><span class="token class-name">RestController</span><span class="token punctuation">;</span>

<span class="token annotation punctuation">@RestController</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">HelloController</span> <span class="token punctuation">{</span>

    <span class="token annotation punctuation">@GetMapping</span><span class="token punctuation">(</span><span class="token string">&quot;/hello&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">hello</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token string">&quot;hello&quot;</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><blockquote><p>코드설명</p> <ol><li>@RestController
<ul><li>컨트롤러를 JSON을 반환하는 컨트롤러로 만들어 줍니다.</li> <li>예전에는 @ResponseBody를 각 메소드마다 선언했던 것을 한번에 사용할 수 있게 해준다.</li></ul></li> <li>@GetMapping
<ul><li>HTTP Method인 Get인 요청을 받을 수 있는 API를 만들어 준다.</li> <li>예전에는 @RequestMapping(method = RequestMethod.GET)으로 사용되었습니다.</li></ul></li></ol></blockquote> <h3 id="hellocontrollertest-class-작성"><a href="#hellocontrollertest-class-작성" aria-hidden="true" class="header-anchor">#</a> HelloControllerTest Class 작성</h3> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>swchoi<span class="token punctuation">.</span>webservice<span class="token punctuation">.</span>springboot<span class="token punctuation">.</span>web</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>junit</span><span class="token punctuation">.</span><span class="token class-name">Test</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>junit<span class="token punctuation">.</span>runner</span><span class="token punctuation">.</span><span class="token class-name">RunWith</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>beans<span class="token punctuation">.</span>factory<span class="token punctuation">.</span>annotation</span><span class="token punctuation">.</span><span class="token class-name">Autowired</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>boot<span class="token punctuation">.</span>test<span class="token punctuation">.</span>autoconfigure<span class="token punctuation">.</span>web<span class="token punctuation">.</span>servlet</span><span class="token punctuation">.</span><span class="token class-name">WebMvcTest</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>test<span class="token punctuation">.</span>context<span class="token punctuation">.</span>junit4</span><span class="token punctuation">.</span><span class="token class-name">SpringRunner</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>test<span class="token punctuation">.</span>web<span class="token punctuation">.</span>servlet</span><span class="token punctuation">.</span><span class="token class-name">MockMvc</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token keyword">static</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>test<span class="token punctuation">.</span>web<span class="token punctuation">.</span>servlet<span class="token punctuation">.</span>request</span><span class="token punctuation">.</span><span class="token class-name">MockMvcRequestBuilders</span><span class="token punctuation">.</span>get<span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token keyword">static</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>test<span class="token punctuation">.</span>web<span class="token punctuation">.</span>servlet<span class="token punctuation">.</span>result</span><span class="token punctuation">.</span><span class="token class-name">MockMvcResultMatchers</span><span class="token punctuation">.</span>content<span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token keyword">static</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>test<span class="token punctuation">.</span>web<span class="token punctuation">.</span>servlet<span class="token punctuation">.</span>result</span><span class="token punctuation">.</span><span class="token class-name">MockMvcResultMatchers</span><span class="token punctuation">.</span>status<span class="token punctuation">;</span>

<span class="token annotation punctuation">@RunWith</span><span class="token punctuation">(</span><span class="token class-name">SpringRunner</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span>
<span class="token annotation punctuation">@WebMvcTest</span><span class="token punctuation">(</span>controllers <span class="token operator">=</span> <span class="token class-name">HelloController</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">HelloControllerTest</span> <span class="token punctuation">{</span>

    <span class="token annotation punctuation">@Autowired</span>
    <span class="token keyword">private</span> <span class="token class-name">MockMvc</span> mvc<span class="token punctuation">;</span>

    <span class="token annotation punctuation">@Test</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> hello가_리턴된다<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span>  <span class="token class-name">Exception</span> <span class="token punctuation">{</span>
        <span class="token class-name">String</span> hello <span class="token operator">=</span> <span class="token string">&quot;hello&quot;</span><span class="token punctuation">;</span>

        mvc<span class="token punctuation">.</span><span class="token function">perform</span><span class="token punctuation">(</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">&quot;/hello&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">andExpect</span><span class="token punctuation">(</span><span class="token function">status</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">isOk</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">andExpect</span><span class="token punctuation">(</span><span class="token function">content</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">string</span><span class="token punctuation">(</span>hello<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><blockquote><p>코드설명</p> <ol><li>@RunWith(SpringRunner.class)
<ul><li>테스트를 진행할 때 JUint에 내장된 실행자 외에 다른 실행자를 실행시킵니다.</li> <li>여기서는 SpringRunner라는 스프링 실행자를 사용합니다.</li> <li>즉, 스프링 부트 테스트와 JUnit 사이에 연갈자 역할을 합니다.</li></ul></li> <li>@WebMvcTest
<ul><li>여러 스프링 테스트 어노테이션 중, Web(Spring MVC)에 집중할 수 있는 어노테이션입니다.</li> <li>선언할 경우 @Controller, @ControllerAdvice 등을 사용할 수 있습니다.</li> <li>단, @Service, @Component, @Repository 등은 사용할 수 없다.</li> <li>여기서는 컨트롤러만 사용한다.</li></ul></li> <li>@Autowired
<ul><li>스프링이 관리하는 빈(Bean)을 주입 받는다.</li></ul></li> <li>private MockMvc mvc
<ul><li>웹 API를 테스트할 때 사용</li> <li>스프링 MVC 테스트의 시작점</li> <li>이 클래스를 통해 HTTP GET,POST 등에 대한 API 테스트를 할 수 있다.</li></ul></li> <li>mvc.perform(get(&quot;/hello&quot;))
<ul><li>MockMvc를 통해 /hello 주소로 HTTP GET 요청을 한다.</li> <li>체이닝이 지원되어 아래와 같이 여러 검증 기능을 이어서 선언할 수 있다.</li></ul></li> <li>.andExpect(status().isOk())
<ul><li>mvc.perform의 결과를 검증한다.</li> <li>HTTP Header의 Status를 검증합니다.</li> <li>우리가 흔히 알고 있는 200,404,500 등의 상태를 검증한다.</li></ul></li> <li>.andExpect(content().string(hello))
<ul><li>mvc.perform의 결과를 검증한다.</li> <li>응답 본문의 내용을 검증한다.</li></ul></li></ol></blockquote> <h2 id="_3-lombok-소개-및-설치하기"><a href="#_3-lombok-소개-및-설치하기" aria-hidden="true" class="header-anchor">#</a> 3. Lombok 소개 및 설치하기</h2> <p><strong>자바 개발자들의 필수 라이브러리 롬북(Lombok)</strong> 입니다.</p> <blockquote><p>build.gradle 파일에 추가 한다.</p> <div class="language- extra-class"><pre class="language-text"><code>compile('org.projectlombok:lombok')
</code></pre></div><p><img src="/about-me/assets/img/test2.3ffa4097.png" alt="lombok"></p></blockquote> <blockquote><p>인텔리j lombok 플러그인 추가</p> <p><img src="/about-me/assets/img/test3.4782183d.png" alt="lombok 플러그인"></p></blockquote> <blockquote><p>롬북 설정 (Enalbe annotation processing 체크)</p> <p><img src="/about-me/assets/img/test4.85bbbab5.png" alt="lombok 설정"></p></blockquote> <h2 id="_4-dto-롬북-테스트-코드-작성하기"><a href="#_4-dto-롬북-테스트-코드-작성하기" aria-hidden="true" class="header-anchor">#</a> 4. DTO 롬북 테스트 코드 작성하기</h2> <h3 id="helloresponsedto-클래스-생성"><a href="#helloresponsedto-클래스-생성" aria-hidden="true" class="header-anchor">#</a> HelloResponseDto 클래스 생성</h3> <blockquote><div class="language-JAVA extra-class"><pre class="language-java"><code><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>swchoi<span class="token punctuation">.</span>webservice<span class="token punctuation">.</span>springboot<span class="token punctuation">.</span>web<span class="token punctuation">.</span>dto</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> lombok<span class="token punctuation">.</span><span class="token class-name">Getter</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> lombok<span class="token punctuation">.</span><span class="token class-name">RequiredArgsConstructor</span><span class="token punctuation">;</span>

<span class="token annotation punctuation">@Getter</span>
<span class="token annotation punctuation">@RequiredArgsConstructor</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">HelloResponseDto</span> <span class="token punctuation">{</span>

   <span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token class-name">String</span> name<span class="token punctuation">;</span>
   <span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token keyword">int</span> amount<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

</code></pre></div></blockquote> <h4 id="코드설명"><a href="#코드설명" aria-hidden="true" class="header-anchor">#</a> 코드설명</h4> <ol><li><strong>@Getter</strong> <ul><li>선언된 모든 필드의 get 메소드를 생성해 줍니다.</li></ul></li> <li><strong>@RequiredArgsConstructor</strong> <ul><li>선언된 모든 final 필드가 포함된 생성자를 생성해 줍니다.</li> <li>final이 없는 필드는 생성자에 포함되지 않습니다.</li></ul></li></ol> <h3 id="helloresponsedtotest-클래스-생성"><a href="#helloresponsedtotest-클래스-생성" aria-hidden="true" class="header-anchor">#</a> HelloResponseDtoTest 클래스 생성</h3> <blockquote><div class="language-JAVA extra-class"><pre class="language-java"><code><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>swchoi<span class="token punctuation">.</span>webservice<span class="token punctuation">.</span>springboot<span class="token punctuation">.</span>web<span class="token punctuation">.</span>dto</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>junit</span><span class="token punctuation">.</span><span class="token class-name">Test</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token keyword">static</span> <span class="token namespace">org<span class="token punctuation">.</span>assertj<span class="token punctuation">.</span>core<span class="token punctuation">.</span>api</span><span class="token punctuation">.</span><span class="token class-name">Assertions</span><span class="token punctuation">.</span>assertThat<span class="token punctuation">;</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">HelloResponseDtoTest</span> <span class="token punctuation">{</span>

   <span class="token annotation punctuation">@Test</span>
   <span class="token keyword">public</span> <span class="token keyword">void</span> 롬북_기능_테스트<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
       <span class="token comment">//given</span>
       <span class="token class-name">String</span> name <span class="token operator">=</span> <span class="token string">&quot;test&quot;</span><span class="token punctuation">;</span>
       <span class="token keyword">int</span> amount <span class="token operator">=</span> <span class="token number">1000</span><span class="token punctuation">;</span>

       <span class="token comment">//when</span>
       <span class="token class-name">HelloResponseDto</span> dto <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HelloResponseDto</span><span class="token punctuation">(</span>name<span class="token punctuation">,</span>amount<span class="token punctuation">)</span><span class="token punctuation">;</span>

       <span class="token comment">//then</span>
       <span class="token function">assertThat</span><span class="token punctuation">(</span>dto<span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">isEqualTo</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>
       <span class="token function">assertThat</span><span class="token punctuation">(</span>dto<span class="token punctuation">.</span><span class="token function">getAmount</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">isEqualTo</span><span class="token punctuation">(</span>amount<span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre></div></blockquote> <h4 id="코드설명-2"><a href="#코드설명-2" aria-hidden="true" class="header-anchor">#</a> 코드설명</h4> <ol><li><strong>assertThat</strong> <ul><li>assertj라는 테스트 검증 라이브러리의 검증 메소드입니다.</li></ul></li> <li><strong>isEqualTo</strong> <ul><li>검증하고 싶은 대상을 메소드 인자로 받는다.</li> <li>메소드 체이닝이 지원되어 isEqualTo와 같이 메소드를 이어서 사용할 수 있다.</li></ul></li></ol> <h3 id="hellocontroller-메소드-추가"><a href="#hellocontroller-메소드-추가" aria-hidden="true" class="header-anchor">#</a> HelloController 메소드 추가</h3> <div class="language-java extra-class"><pre class="language-java"><code>    <span class="token annotation punctuation">@GetMapping</span><span class="token punctuation">(</span><span class="token string">&quot;/hello/dto&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token class-name">HelloResponseDto</span> <span class="token function">helloDto</span><span class="token punctuation">(</span><span class="token annotation punctuation">@RequestParam</span><span class="token punctuation">(</span><span class="token string">&quot;name&quot;</span><span class="token punctuation">)</span> <span class="token class-name">String</span> name<span class="token punctuation">,</span>
                                     <span class="token annotation punctuation">@RequestParam</span><span class="token punctuation">(</span><span class="token string">&quot;amount&quot;</span><span class="token punctuation">)</span> <span class="token keyword">int</span> amount<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">HelloResponseDto</span><span class="token punctuation">(</span>name<span class="token punctuation">,</span> amount<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
</code></pre></div><h4 id="코드설명-3"><a href="#코드설명-3" aria-hidden="true" class="header-anchor">#</a> 코드설명</h4> <ol><li><strong>@RequestParam</strong> <ul><li>외부에서 API로 넘긴 파라미터를 가져오는 어노테이션</li></ul></li></ol> <h3 id="hellocontrollertest-메소드-추가"><a href="#hellocontrollertest-메소드-추가" aria-hidden="true" class="header-anchor">#</a> HelloControllerTest 메소드 추가</h3> <div class="language-java extra-class"><pre class="language-java"><code>    <span class="token annotation punctuation">@Test</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> helloDto가_리턴된다<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span>  <span class="token class-name">Exception</span> <span class="token punctuation">{</span>
        <span class="token class-name">String</span> name <span class="token operator">=</span> <span class="token string">&quot;hello&quot;</span><span class="token punctuation">;</span>
        <span class="token keyword">int</span> amount <span class="token operator">=</span> <span class="token number">1000</span><span class="token punctuation">;</span>

        mvc<span class="token punctuation">.</span><span class="token function">perform</span><span class="token punctuation">(</span>
                    <span class="token function">get</span><span class="token punctuation">(</span><span class="token string">&quot;/hello/dto&quot;</span><span class="token punctuation">)</span>
                            <span class="token punctuation">.</span><span class="token function">param</span><span class="token punctuation">(</span><span class="token string">&quot;name&quot;</span><span class="token punctuation">,</span> name<span class="token punctuation">)</span>
                            <span class="token punctuation">.</span><span class="token function">param</span><span class="token punctuation">(</span><span class="token string">&quot;amount&quot;</span><span class="token punctuation">,</span> <span class="token class-name">String</span><span class="token punctuation">.</span><span class="token function">valueOf</span><span class="token punctuation">(</span>amount<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">andExpect</span><span class="token punctuation">(</span><span class="token function">status</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">isOk</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">andExpect</span><span class="token punctuation">(</span><span class="token function">jsonPath</span><span class="token punctuation">(</span><span class="token string">&quot;$.name&quot;</span><span class="token punctuation">,</span> <span class="token function">is</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">andExpect</span><span class="token punctuation">(</span><span class="token function">jsonPath</span><span class="token punctuation">(</span><span class="token string">&quot;$.amount&quot;</span><span class="token punctuation">,</span> <span class="token function">is</span><span class="token punctuation">(</span>amount<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
</code></pre></div><h4 id="코드설명-4"><a href="#코드설명-4" aria-hidden="true" class="header-anchor">#</a> 코드설명</h4> <ol><li><strong>param</strong> <ul><li>API 테스트할 때 사용될 요청 파라미터를 설정</li> <li>단, 값은 String만 허용됩니다.</li> <li>숫자/날짜 등의 데이터도 작성할 때는 문자열로 변경해야한 가능</li></ul></li> <li><strong>jsonPath</strong> <ul><li>JSON 응답값을 필드별로 검증할 수 있는 메소드입니다.</li> <li>$를 기준으로 필드명을 명시합니다.</li></ul></li></ol></div> <div class="page-edit"><div class="edit-link"><a href="https://github.com/ChoiSeungWon/about-me/edit/master/docs/spring/chater02/README.md" target="_blank" rel="noopener noreferrer">Edit this page</a> <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></div> <div class="last-updated"><span class="prefix">Last Updated: </span> <span class="time">3/15/2020, 8:16:30 PM</span></div></div> <div class="page-nav"><p class="inner"><span class="prev">
        ←
        <a href="/about-me/spring/chater01/" class="prev">
          Gradle Spring Boot 프로젝트 생성
        </a></span> <span class="next"><a href="/about-me/spring/chater03/">
          Spring Boot에서 JPA 사용하기
        </a>
        →
      </span></p></div> </div> <!----></div></div>
    <script src="/about-me/assets/js/app.1fd5ee7f.js" defer></script><script src="/about-me/assets/js/12.0a416c4b.js" defer></script>
  </body>
</html>
